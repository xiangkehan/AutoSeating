# 自动排座位系统 - 离线管理端快速启动指南

## 脚本简介

为了便捷地初始化并运行离线端程序，我们提供了四个快速启动脚本：

1. `start-offline.bat` - 中文Windows批处理脚本，功能完整
2. `start-offline-simple.bat` - 中文简化版Windows批处理脚本，仅包含核心功能
3. `start-offline-english.bat` - 英文Windows批处理脚本，避免中文编码问题
4. `start-offline.ps1` - PowerShell脚本，提供更丰富的功能和更好的错误处理

这些脚本会自动完成环境检查、依赖安装和程序启动等步骤，确保离线端可快速投入使用。

## 脚本功能对比

| 脚本名称 | 语言 | 功能特点 | 适用场景 |
|---------|------|---------|---------|
| start-offline.bat | 中文 | 功能完整，包含详细提示和错误处理 | 大多数Windows用户 |
| start-offline-simple.bat | 中文 | 简化版，仅包含核心功能，避免编码问题 | 遇到中文编码问题的用户 |
| start-offline-english.bat | 英文 | 全英文界面，完全避免中文编码问题 | 遇到严重中文编码问题的用户 |
| start-offline.ps1 | 中文 | 功能最丰富，提供最佳错误处理和用户体验 | PowerShell用户，高级使用场景 |

## 使用方法

### 使用批处理脚本（推荐所有Windows用户）

#### 标准批处理脚本 (start-offline.bat)
1. 在文件资源管理器中找到项目根目录下的`start-offline.bat`文件
2. 双击该文件即可运行
3. 脚本会自动完成所有必要步骤并启动离线管理端

#### 简化版批处理脚本 (start-offline-simple.bat)
1. 如果标准批处理脚本出现编码错误，可以尝试使用此简化版
2. 在文件资源管理器中找到项目根目录下的`start-offline-simple.bat`文件
3. 双击该文件即可运行

#### 英文版批处理脚本 (start-offline-english.bat)
1. 如果上述脚本都出现编码问题，可以尝试使用此英文版脚本
2. 在文件资源管理器中找到项目根目录下的`start-offline-english.bat`文件
3. 双击该文件即可运行

### 使用PowerShell脚本（推荐高级用户）

1. 在文件资源管理器中找到项目根目录下的`start-offline.ps1`文件
2. 右键点击该文件，选择"使用PowerShell运行"
3. 如果遇到执行策略限制，可以以管理员身份打开PowerShell，执行以下命令后再运行脚本：
   ```powershell
   Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
   ```
4. 脚本会自动完成所有必要步骤并启动离线管理端

## 注意事项

1. 首次运行脚本时，由于需要安装依赖，可能需要较长时间，请耐心等待
2. 请确保您的计算机已连接到互联网，以便能够下载所需的依赖包
3. 如果您修改了项目代码或依赖，请重新运行脚本来更新依赖
4. 脚本运行过程中请勿关闭命令行窗口，否则会中断程序运行
5. 如果遇到任何问题，脚本会显示错误信息和解决方案提示
6. 在某些Windows系统上可能会遇到中文编码问题，如果遇到，请尝试使用`start-offline-simple.bat`或`start-offline-english.bat`脚本

## 常见问题解决

**问题**：运行脚本时提示"未找到Node.js" 
**解决方案**：请先从 [Node.js官网](https://nodejs.org/) 下载并安装最新版本的Node.js

**问题**：依赖安装失败 
**解决方案**：检查您的网络连接，然后重新运行脚本。如果问题持续，请手动删除`desktop/node_modules`目录后再试

**问题**：程序启动后闪退 
**解决方案**：请查看命令行窗口中的错误信息，然后根据提示进行修复

**问题**：运行脚本时出现乱码或"不是内部或外部命令"错误 
**解决方案**：这通常是中文编码问题，请尝试使用以下方法：
1. 首先尝试`start-offline-simple.bat`简化版脚本
2. 如果仍然有问题，尝试`start-offline-english.bat`英文版脚本
3. 或者使用PowerShell脚本`start-offline.ps1`

**问题**：无法运行PowerShell脚本 
**解决方案**：以管理员身份打开PowerShell，执行以下命令来更改执行策略：
```powershell
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
```

**问题**：云函数连接失败 (ENOTFOUND 错误)
**解决方案**：
- 确认从小程序端获取的云函数地址完全正确，不要添加额外的斜杠或路径
- 检查网络连接是否正常，确保可以访问互联网
- 在系统设置中重新输入正确的云函数地址并保存

**问题**：云函数连接被拒绝 (ECONNREFUSED 错误)
**解决方案**：
- 确认云函数已成功部署且状态正常
- 检查云函数的访问权限设置
- 联系小程序管理员确认云函数服务状态

**问题**：默认云函数地址警告
**解决方案**：在离线管理端的系统设置页面中，输入从小程序端获取的正确云函数地址并保存

## 云函数地址配置指南

1. **获取正确的云函数地址**
   - 从小程序端的系统设置页面或管理员处获取云函数URL
   - 确保地址格式正确，通常类似于`https://cloudfunctionname.region.appid.cloudbaseapp.com`

2. **配置云函数地址**
   - 在离线管理端启动后，点击顶部菜单的"工具" -> "设置"
   - 在"云同步设置"区域，找到"云端接口地址"输入框
   - 粘贴正确的云函数地址，点击"保存设置"按钮
   - 系统会自动更新同步管理器并尝试连接新地址

3. **验证连接状态**
   - 点击顶部菜单的"数据" -> "同步状态"查看连接状态
   - 如果显示"在线"，表示已成功连接到云端
   - 如果显示"离线"，请检查地址是否正确并尝试重新连接

## 联系我们

如果您在使用过程中遇到任何问题，请联系技术支持团队获取帮助。