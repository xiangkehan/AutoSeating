<!--pages/audit-logs/audit-logs.wxml-->
<view class=\"audit-logs-container\">
  <!-- é¡µé¢æ ‡é¢˜ -->
  <view class=\"page-header\">
    <text class=\"page-title\">å®¡è®¡æ—¥å¿—</text>
    <view class=\"header-actions\">
      <button class=\"action-btn\" bind:tap=\"toggleStatistics\">
        <text class=\"icon\">ğŸ“Š</text>
        ç»Ÿè®¡
      </button>
      <button class=\"action-btn\" bind:tap=\"toggleFilters\">
        <text class=\"icon\">ğŸ”</text>
        ç­›é€‰
      </button>
    </view>
  </view>

  <!-- ç»Ÿè®¡ä¿¡æ¯ -->
  <view class=\"statistics-panel\" wx:if=\"{{showStatistics && statistics}}\">
    <view class=\"statistics-header\">
      <text class=\"section-title\">æœ€è¿‘7å¤©ç»Ÿè®¡</text>
    </view>
    
    <view class=\"stats-grid\">
      <view class=\"stat-item\">
        <text class=\"stat-label\">æ€»æ“ä½œæ•°</text>
        <text class=\"stat-value\">{{totalCount}}</text>
      </view>
      
      <view class=\"stat-item\" wx:for=\"{{statistics.severity_stats}}\" wx:key=\"_id\">
        <text class=\"stat-label\">{{item._id}}é£é™©æ“ä½œ</text>
        <text class=\"stat-value\">{{item.count}}</text>
      </view>
    </view>
  </view>

  <!-- ç­›é€‰é¢æ¿ -->
  <view class=\"filter-panel\" wx:if=\"{{showFilters}}\">
    <view class=\"filter-header\">
      <text class=\"section-title\">ç­›é€‰æ¡ä»¶</text>
    </view>
    
    <view class=\"filter-grid\">
      <view class=\"filter-item\">
        <text class=\"filter-label\">æ“ä½œç±»å‹</text>
        <picker 
          range=\"{{operationOptions}}\" 
          range-key=\"label\" 
          value=\"{{filters.operation}}\"
          data-field=\"operation\"
          bind:change=\"onFilterChange\"
        >
          <view class=\"picker-display\">
            {{filters.operation ? (operationOptions.find(item => item.value === filters.operation)).label : 'å…¨éƒ¨æ“ä½œ'}}
          </view>
        </picker>
      </view>
      
      <view class=\"filter-item\">
        <text class=\"filter-label\">é£é™©çº§åˆ«</text>
        <picker 
          range=\"{{severityOptions}}\" 
          range-key=\"label\" 
          value=\"{{filters.severity}}\"
          data-field=\"severity\"
          bind:change=\"onFilterChange\"
        >
          <view class=\"picker-display\">
            {{filters.severity ? (severityOptions.find(item => item.value === filters.severity)).label : 'å…¨éƒ¨çº§åˆ«'}}
          </view>
        </picker>
      </view>
      
      <view class=\"filter-item\">
        <text class=\"filter-label\">çŠ¶æ€</text>
        <picker 
          range=\"{{statusOptions}}\" 
          range-key=\"label\" 
          value=\"{{filters.status}}\"
          data-field=\"status\"
          bind:change=\"onFilterChange\"
        >
          <view class=\"picker-display\">
            {{filters.status ? (statusOptions.find(item => item.value === filters.status)).label : 'å…¨éƒ¨çŠ¶æ€'}}
          </view>
        </picker>
      </view>
    </view>
    
    <view class=\"filter-actions\">
      <button class=\"filter-btn secondary\" bind:tap=\"clearFilters\">æ¸…é™¤</button>
      <button class=\"filter-btn primary\" bind:tap=\"applyFilters\">åº”ç”¨</button>
    </view>
  </view>

  <!-- æ—¥å¿—åˆ—è¡¨ -->
  <view class=\"logs-list\">
    <view 
      class=\"log-item\" 
      wx:for=\"{{logs}}\" 
      wx:key=\"log_id\"
      data-log=\"{{item}}\"
      bind:tap=\"viewLogDetail\"
    >
      <view class=\"log-header\">
        <view class=\"log-operation\">
          <text class=\"operation-text\">{{getOperationText(item.operation)}}</text>
          <view class=\"severity-badge {{getSeverityClass(item.severity)}}\">
            {{getSeverityText(item.severity)}}
          </view>
        </view>
        <text class=\"log-time\">{{formatDate(item.timestamp)}}</text>
      </view>
      
      <view class=\"log-content\">
        <view class=\"log-detail\">
          <text class=\"detail-label\">ç›®æ ‡ï¼š</text>
          <text class=\"detail-value\">{{item.target}}</text>
        </view>
        
        <view class=\"log-detail\" wx:if=\"{{item.details}}\">
          <text class=\"detail-label\">è¯¦æƒ…ï¼š</text>
          <text class=\"detail-value\">{{item.details}}</text>
        </view>
        
        <view class=\"log-detail\">
          <text class=\"detail-label\">ç”¨æˆ·ï¼š</text>
          <text class=\"detail-value\">{{item.user_name}} ({{item.user_role}})</text>
        </view>
      </view>
      
      <view class=\"log-status\">
        <view class=\"status-badge {{item.status === 'success' ? 'status-success' : 'status-error'}}\">
          {{item.status === 'success' ? 'æˆåŠŸ' : 'å¤±è´¥'}}
        </view>
      </view>
    </view>
    
    <!-- åŠ è½½æ›´å¤š -->
    <view class=\"load-more\" wx:if=\"{{hasMore}}\">
      <view class=\"loading\" wx:if=\"{{loading}}\">
        <text class=\"loading-text\">åŠ è½½ä¸­...</text>
      </view>
      <text class=\"load-tip\" wx:else>ä¸Šæ‹‰åŠ è½½æ›´å¤š</text>
    </view>
    
    <!-- æ²¡æœ‰æ›´å¤šæ•°æ® -->
    <view class=\"no-more\" wx:if=\"{{!hasMore && logs.length > 0}}\">
      <text class=\"no-more-text\">æ²¡æœ‰æ›´å¤šæ•°æ®äº†</text>
    </view>
    
    <!-- ç©ºçŠ¶æ€ -->
    <view class=\"empty-state\" wx:if=\"{{logs.length === 0 && !loading}}\">
      <text class=\"empty-icon\">ğŸ“</text>
      <text class=\"empty-text\">æš‚æ— å®¡è®¡æ—¥å¿—</text>
    </view>
  </view>
</view>", "original_text": "", "new_text": "", "file_path": "c:\\Users\\xjh20\\WeChatProjects\\miniprogram-2\\miniprogram\\pages\\audit-logs\\audit-logs.wxml"}]